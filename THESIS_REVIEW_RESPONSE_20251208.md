# 석사 논문 심사 피드백 대응안 (2025-12-08)

본 문서는 현재 스캐폴드( CRAG 기반 멀티턴 의료 상담 에이전트 )에 대해 심사위원 피드백을 정리하고, 개선 방안·실행 계획·기대효과, 그리고 기술적·학술적 기여도를 논의한다. 끝부분에 예상 공격 질문 10개와 모범 답안을 포함하였다. 석사 연구로서의 범위를 명확히 인정한다.

---

## 1. 피드백 요약
- CRAG 내부 순환 vs LangGraph 외부 순환의 차이/목적/실 구현이 불명확.
- 멀티턴 실험 비교가 마지막 질문(“앞으로 건강 관리는…”)만으로 보이는 문제.
- Context Engineering 핵심 3요소(사용자 정보 수집·동적 문서 활용·멀티턴 메모리)의 구현 및 성능 비교 부재.

---

## 2. 대응 전략 및 실행 방안

### 2.1 CRAG 내부 순환 vs LangGraph 외부 순환 명료화
- **개념 정리**:  
  - 내부 순환(CRAG Self-Refine Loop): 단일 턴 내에서 후보 응답을 생성→평가→수정하여 품질/안전성을 높이는 마이크로 루프.  
  - 외부 순환(LangGraph Flow): 대화 세션 전체를 관리하며 멀티턴 컨텍스트 축적, 메모리 업데이트, 도메인 문서 선택을 수행하는 매크로 루프.
- **실행 계획**:  
  - 아키텍처 도식 추가: 외부(회색) 그래프 위에 내부(주황) 셀프 리파인 루프를 중첩 표시.  
  - 구현 설명: 노드/에지별 역할(예: Retriever→Generator→Judge→Refiner)과 상태(state) 필드(컨텍스트, 메모리, 안전 플래그 등) 명시.  
  - 실험: 내부 루프 on/off, 외부 루프 동일 조건으로 ablation 실시.
- **기대효과**: 셀프 리파인 on 시 임상 관련성↑, 금지 응답률↓, 길이 안정성↑. 외부 루프는 멀티턴 일관성 유지와 누락된 컨텍스트 보전을 입증.

### 2.2 멀티턴 비교 범위 확장
- **문제 정의**: 마지막 턴만 비교하면 멀티턴 축적 효과와 오류 전파가 드러나지 않음.
- **실행 계획**:  
  - 20–30개 멀티턴 시나리오(3–5턴) 벤치 구성: 증상·약물·생활습관·추적 관리 질문 포함.  
  - 평가 지표: 턴별 임상 적합성, 사실성(정답 근거 RAG 문서 매칭), 맥락 일관성, 안전 필터 적중률.  
  - 비교 조건: (a) 단일턴 베이스라인, (b) 멀티턴+메모리, (c) 멀티턴+메모리+셀프 리파인. 각 턴별 점수와 세션 평균 모두 보고.
- **기대효과**: 멀티턴·메모리의 정량적 이득(일관성/안전성)과 셀프 리파인의 추가 개선 폭을 명확히 제시.

### 2.3 Context Engineering 3요소 구현·비교
- **(1) 사용자 정보 수집/활용 (MedCAT2 엔티티 추출)**  
  - 계획: 초기 턴에서 기본 정보 추출(연령, 성별, 기저질환, 약물), 이후 턴에서 업데이트.  
  - 비교: 엔티티 기반 프로필 on/off, 단순 키워드 대비 성능(정확성·금지 응답률) 측정.
- **(2) 동적 문서 활용 (RAG 라우팅)**  
  - 계획: 질문 타입별로 라우터(증상→질병 백서, 약물→약전, 생활습관→가이드라인) + 질의 확장·재작성.  
  - 비교: 정적 단일 인덱스 vs 동적 라우팅 vs 라우팅+질의 재작성.
- **(3) 멀티턴 메모리 관리**  
  - 계획: 대화 상태에 구조화 슬롯(증상, 기간, 약물, 금기, 생활습관)을 유지하고 턴마다 병합.  
  - 비교: 메모리 off vs 요약 메모리 vs 구조화 슬롯 메모리. 턴별 일관성·근거 회수율 측정.
- **기대효과**:  
  - 사용자 정보 on 시 개인화/금기 안내 정밀도↑.  
  - 동적 RAG on 시 관련 근거 문서 hit-rate↑, 환각↓.  
  - 구조화 메모리 on 시 턴간 일관성↑, 중복 질문↓.

---

## 3. 기술적/학술적 기여도 (석사 수준에 맞춘 정리)
- **모듈러 멀티턴 스캐폴드**: 내부 셀프 리파인과 외부 그래프 제어를 분리해 확장성 있는 의료 대화 파이프라인을 제시. 석사 수준에서 구현·실험이 가능한 명확한 아키텍처 제안.
- **컨텍스트 엔지니어링 실증**: 사용자 프로필 수집, 동적 RAG 라우팅, 구조화 메모리의 개별·조합 효과를 소규모 의료 QA 벤치에서 정량화 → 기존 단일턴 RAG 대비 개선 근거 제공.
- **안전성/근거성 결합 평가**: 임상 적합성, 근거 매칭, 안전 필터 적중률을 함께 측정하는 소형 벤치 설계 → 의료 도메인 멀티턴 에이전트 평가 프레이밍에 기여.
- **한계 인정 및 범위 설정**: 상용 임상 현장 적용이 아닌 “컨슈머 건강 상담” 수준으로 스코프를 제한, 대형 의료 검증 없이도 연구 윤리를 준수하는 실험 설계 제시.

---

## 4. 실행 체크리스트
- [ ] CRAG 내부/외부 루프 아키텍처 도식 추가 및 서술 보강.
- [ ] 멀티턴 시나리오 벤치 구성(20–30 세트) 및 턴별 평가 스크립트 작성.
- [ ] Ablation: 셀프 리파인 on/off, 메모리 on/off, RAG 라우팅 on/off, MedCAT2 on/off.
- [ ] 결과 표/그래프(턴별·세션별)와 정성 사례(성공/실패) 추가.
- [ ] 논문 본문에 컨텍스트 엔지니어링 3요소 구현 상세 기술.
- [ ] 한계·윤리·데이터 크기 제약 명시.

---

## 5. 예상 공격 질문 & 모범 답안 (10개)

1) **Q:** 내부 셀프 리파인과 외부 그래프 루프가 중복 아닌가?  
   **A:** 내부 루프는 단일 턴 품질 개선(재생성/재평가)이고, 외부 루프는 세션 상태 관리와 문서 선택·메모리 업데이트를 담당한다. Ablation에서 내부 루프 off 시 동일 컨텍스트에서도 사실성·안전 점수가 하락함을 보고한다.

2) **Q:** 멀티턴 효과를 왜 마지막 턴만 비교했는가?  
   **A:** 보완 중이다. 턴별 평가로 확장하며, 세션 평균과 오류 전파를 함께 제시한다. 새 벤치(20–30 대화)로 재측정 예정이다.

3) **Q:** 사용자 정보 수집(프로파일링)을 비활성화한 경우와 차이는?  
   **A:** MedCAT2 기반 프로필 on/off 실험을 추가한다. 금기·개인화 관련 정확도가 유의하게 상승함을 정량 제시할 계획이다.

4) **Q:** 동적 라우팅 RAG가 정적 인덱스보다 항상 나은가?  
   **A:** 아니며, 질의가 단순할 때는 비슷하다. 하지만 복합 질문에서 관련 문서 hit-rate가 개선됨을 실험으로 보인다. 라우팅 실패 사례도 함께 보고한다.

5) **Q:** 메모리 누적이 환각을 유발할 수 있는데 방어는?  
   **A:** 구조화 슬롯 메모리로 상태를 제한하고, 각 턴에 근거 문서 근접성이 낮으면 보수적 응답/거부를 하도록 안전 필터를 둔다. 메모리 on/off 비교에서 안전성 지표를 함께 제시한다.

6) **Q:** 셀프 리파인으로 인퍼런스 비용이 늘어난다. 비용 대비 성능 근거는?  
   **A:** 후보 2~3개 제한과 휴리스틱 early-stop을 적용한다. 비용 대비 성능 Δ를 표로 제시하고, 비용 민감한 설정에서는 내부 루프를 끌 수 있음을 명시한다.

7) **Q:** 평가 데이터 규모가 작다. 통계적 유의성을 어떻게 담보하나?  
   **A:** 소형 벤치이므로 신뢰구간과 효과 크기를 함께 보고하고, 재현 가능한 스크립트를 공개한다. 석사 연구 한계를 명확히 기재한다.

8) **Q:** 의료 안전성 검증을 임상 수준으로 했는가?  
   **A:** 아니다. 컨슈머 헬스케어 수준으로 범위를 제한했으며, 임상 적용에는 추가 검증이 필요함을 한계로 명시한다.

9) **Q:** 사용자 정보 수집이 개인정보 침해 소지가 있다.  
   **A:** 모든 정보는 세션 내 일시 처리하고, 식별자/위치 정보는 수집하지 않는다. 프라이버시-우선 설계와 거부 응답 정책을 문서화한다.

10) **Q:** 왜 기존 공개 벤치(예: MedQA) 대신 자체 시나리오를 썼나?  
    **A:** 멀티턴 개인화/생활습관 맥락을 포함하려면 자체 시나리오가 필요하다. 가능하면 공개 벤치의 단일턴 문제도 보조로 포함해 비교를 보고한다.

---

## 6. 한계 인정
- 데이터·벤치 규모가 작아 통계적 일반화가 제한적이다.
- 상용 임상 검증을 수행하지 않았으므로 의료 의사결정 지원 용도로 바로 사용 불가함을 명시한다.
- 인퍼런스 비용과 응답 지연이 셀프 리파인 설정에 따라 증가할 수 있다.
- 언어·도메인 편향 가능성을 완전히 제거하지 못했음을 밝힌다.

---

## 7. 기대효과
- 명확한 아키텍처 구분(내부/외부 루프)과 실험적 근거 제시로 심사 신뢰성 향상.
- 멀티턴 전 구간 평가로 컨텍스트 축적 효과와 안전성 개선을 설득력 있게 입증.
- 컨텍스트 엔지니어링 3요소의 기여도를 정량화하여 학술적 기여도를 분명히 함.
- 한계와 스코프를 투명하게 제시해 석사 연구로서의 적정성 확보.

